{% import "macros.html" as macros %}
{% extends "layout.html" %}

{% block article_body %}

{% markdown %}
{{ data.content.intro }}
{% endmarkdown %}

<div id="key-container">
  <div>KEY</div>
  <div id="key">
    <div class="key-row">
      {% for group in groups %}
        <span class="summary-item item__{{ group }}">
          <span class="key__bullet"></span>
          <span class="item__name">{% if group === 'industrials' %}Industrial products / technology{% else %}{{ group | capitalize }}{% endif %}</span>
        </span>
      {% endfor %}
      <span class="summary-item item__others">
        <span class="key__bullet"></span>
        <span class="item__name">Others*</span>
      </span>
    </div>
    <div class="key-row">
      <span class="summary-item item__chinese">
        <span class="key__bullet"></span>
        <span class="item__name">Chinese tariffs on US goods</span>
      </span>
      <span class="summary-item item__us">
        <span class="key__bullet"></span>
        <span class="item__name">US tariffs on Chinese goods</span>
      </span>
    </div>
  </div>
</div>

<div id="summary-graphic">
  <div id="summary-graphic__label">Total tariffs</div>
  <div class="bar-group-name"><a href="#2018-04-05"> {{ "2018-04-05" | formatDate('dddd, MMMM D') }}</a> ($100bn in US imports from China, proposed tariffs)</div>
  <div class="bar-container">
    <span class="bar item__other" data-category="other" style="width: 100%;"></span>
  </div>
  {% for group in categorySummary %}
  <div class="bar-group-name"><a href="#{{ group.dateGroup }}">{{ group.dateGroup | formatDate('dddd, MMMM D') }}</a> (${{ group.totalValue | roundBillion }}bn in {% if group.country == 'China' %}Chinese imports from the US{% else %}US imports from China{% endif %}{% if group.dateGroup === '2018-03-23' or group.dateGroup === '2018-04-02' %}, tariffs in effect{% else %}, proposed tariffs{% endif %})</div>
  <div class="bar-container">
    {% for category, items in group.categories %}
    <span class="bar item__{{category}}" data-category="{{ category }}" data-dollareffect="{{ items | getDollarSum }}" style="width: {{ 100 * (items | getDollarSum / maxValue) }}%"></span>
    {% endfor %}
    <span class="bar item__other" data-category="other" style="width: {{ 100 * (group.totalValue / maxValue) }}%"></span>
  </div>
{% endfor %}
</div>

{% for row in timeline %}
  <h2 id="{{ row.name }}">{{ row.name | formatDate('dddd, MMMM D, YYYY') }}</h2>
  <p>{{ row.blurb }}</p>
  {% if groupedItems[row.name] | length > 0 %}
  <ol>
    {% for item in groupedItems[row.name] %}
    <li class="item__{{ item.category }}" data-dollareffect="{{ item.dollareffect }}">
      <span class="item__bullet">â€¢</span>
      <span class="item__name">{{ item.englishgoogletranslation }}</span>
    </li>
    {% endfor %}
  </ol>
  {% endif %}
{% endfor %}

<div id="sources">
  {% markdown %}
  {{ data.content.sources }}
  {% endmarkdown %}
</div>

{% endblock %}
